---
title: CMake Cookbook Inrto
tags:
  - tools
  - cmake
categories:
  - CMakeCookbook
date created: 2024-10-01 14:10:00
date modified: 2024-10-01 16:10:65
---
## 前言

CMake是一个构建生成器，提供了强大的领域特定语言(DSL)来描述构建系统应该实现的功能。这是CMake的主要优势之一，它允许使用相同的CMake脚本集生成平台原生构建系统。CMake软件工具集，使开发人员可以完全控制给定项目的生命周期：

- **CMake**是描述如何在所有主要硬件和操作系统上配置、构建和安装项目，无论是构建可执行文件、库，还是两者都要构建。
- **CTest**定义测试、测试套件，并设置应该如何执行。
- **CPack**为打包需求提供了DSL。
- **CDash**将项目的测试结果在面板中展示。

## 覆盖内容

我们将讨论以下内容：

- 使用CMake配置、构建、测试和安装代码项目
- 检测用于条件编译的操作系统、处理器、库、文件和程序
- 提高代码的可移植性
- CMake帮助下，将大型代码库重构为模块
- 构建多语言项目
- 知道如何调整他人编写的CMake配置文件
- 打包项目进行发布
- 将项目迁移为CMake构建

CMake管理的项目的工作流发生在许多阶段(time)，我们称之为*时序*。可以简洁地总结如下图：

![](https://github.com/amor-mio-de-mi-vida/picx-images-hosting/raw/master/cmake/0_1.231urgqru9.webp)

- **CMake time**或**configure time**，是CMake运行时的情况。这个阶段中，CMake将处理项目中的CMakeLists.txt文件并配置它。
- **Generation time**配置成功后，CMake将生成本地构建工具所需的脚本，以执行项目中的后续步骤。
- **Build time**这是在平台和工具原生构建脚本上调用原生构建工具的时候，这些脚本以前是由CMake生成的。此时，将调用编译器，并在特定的构建目录中构建目标(可执行文件和库)。注意递归的CMake time箭头：这看起来令人困惑，但是我们将在本书中多次使用它，用来实现平台无关的构建。
- **CTest time**或 **test time**，运行项目的测试套件，以检查目标是否按预期执行。
- **CDash time**或**report time**，将测试结果上传到面板，与其他开发人员共享。
- **Install time**，将项目的目标、源文件、可执行文件和库从构建目录安装到安装位置。
- **CPack time**或**packaging time**，将项目打包以便发布，可以是源代码，也可以是二进制代码。
- **Package install time**，在系统范围内安装新生成的包。

## 路线图

第1章，从简单的可执行文件到库，如何配置和使用CMake构建简单的可执行文件和库。

第2章，检测环境，如何使用简单的CMake命令与操作系统和处理器体系结构交互。

第3章，检测外部库和程序，如何简化对项目依赖项的检测。

第4章，创建和运行测试，解释如何利用CMake和CTest的功能来定义和运行测试。

第5章，配置时操作和构建时操作，如何使用CMake在构建过程的不同阶段执行定制化操作。

第6章，生成源码，CMake命令可自动生成源码。

第7章，结构化项目，用于组织您的项目，使它们更易于维护。

第8章，超级构建，解释了CMake超级构建模式，用于管理关键项目的依赖关系。

第9章，混合语言项目，构建不同编程语言混合的项目。

第10章，编写一个安装程序，使用CMake安装项目。

第11章，打包项目，如何使用CPack生成源文件，并将源文件打包，以及构建用于发布的Python和Conda包。

第12章，生成文档，如何使用CMake也生成代码的文档。

第13章，选择生成器和交叉编译，如何使用CMake交叉编译项目。

第14章，测试面板，如何将测试结果报告到在面板上。

第15章，将项目移植到CMake中，将展示实践示例、注意事项和一些技巧，这些将帮助您将项目移植到基于CMake的构建系统中。
